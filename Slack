{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "AmazonEC2ContainerRegistryPowerUser",
            "Action": [
                "ecr:Describe*",
                "ecr:Get*",
                "ecr:List*",
                "ecr:PutImage",
                "ecr:DescribeImageScanFindings"
            ],
            "Effect": "Allow",
            "Resource": "*"
        },
        {
            "Sid": "UnRestrictedResourcesRead",
            "Action": [
                "support:*",
                "s3:List*",
                "s3:Get*",
                "secretsmanager:List*",
                "ec2:Describe*",
                "ecs:List*",
                "ecs:Get*",
                "ecs:Put*",
                "ecs:Describe*",
                "ecs:Register*",
                "elasticloadbalancing:Describe*",
                "elasticfilesystem:DescribeAccountPreferences",
                "lambda:List*",
                "lambda:Get*",
                "cloudwatch:DescribeInsightRules",
                "cloudwatch:GetMetricData",
                "cloudwatch:ListMetricStreams",
                "cloudwatch:DescribeAlarmsForMetric",
                "cloudwatch:ListDashboards",
                "cloudwatch:GetMetricStatistics",
                "cloudwatch:GetMetricWidgetImage",
                "cloudwatch:ListManagedInsightRules",
                "cloudwatch:ListMetrics",
                "cloudwatch:DescribeAnomalyDetectors",
                "cloudwatch:GetDashboard",
                "autoscaling:Describe*",
                "kms:List*",
                "tag:Get*",
                "states:List*",
                "states:Describe*",
                "ec2messages:Get*",
                "sqs:ListQueues",
                "sns:ListSMSSandboxPhoneNumbers",
                "sns:ListTopics",
                "sns:GetPlatformApplicationAttributes",
                "sns:GetSubscriptionAttributes",
                "sns:ListSubscriptions",
                "sns:CheckIfPhoneNumberIsOptedOut",
                "sns:ListOriginationNumbers",
                "sns:ListPhoneNumbersOptedOut",
                "sns:ListEndpointsByPlatformApplication",
                "sns:GetEndpointAttributes",
                "sns:GetSMSSandboxAccountStatus",
                "sns:GetSMSAttributes",
                "sns:ListPlatformApplications",
                "iam:List*",
                "iam:GenerateCredentialReport",
                "iam:Get*",
                "rds:Describe*",
                "rds:List*",
                "ec2:StartInstances",
                "ec2:StopInstances",
                "elasticmapreduce:Describe*",
                "elasticmapreduce:List*",
                "elasticmapreduce:ViewEventsFromAllClustersInConsole",
                "acm:Describe*",
                "acm:List*",
                "acm:Get*",
                "kafka:*",
                "datasync:List*",
                "datasync:Describe*",
                "health:Describe*"
            ],
            "Effect": "Allow",
            "Resource": "*"
        },
        {
            "Sid": "SpecificResourceAccess",
            "Action": [
                "apigateway:GET",
                "sns:ListTagsForResource",
                "sns:ListSubscriptionsByTopic",
                "sns:GetTopicAttributes",
                "sns:GetDataProtectionPolicy",
                "sqs:Get*",
                "sqs:ListDeadLetterSourceQueues",
                "sqs:ListMessageMoveTasks",
                "sqs:ListQueueTags",
                "sqs:ReceiveMessage",
                "cloudwatch:DescribeAlarmHistory",
                "cloudwatch:GetDashboard",
                "cloudwatch:ListTagsForResource",
                "cloudwatch:DescribeAlarms",
                "elasticfilesystem:DescribeBackupPolicy",
                "elasticfilesystem:DescribeMountTargets",
                "elasticfilesystem:DescribeTags",
                "elasticfilesystem:DescribeReplicationConfigurations",
                "elasticfilesystem:ListTagsForResource",
                "elasticfilesystem:DescribeLifecycleConfiguration",
                "elasticfilesystem:ClientMount",
                "elasticfilesystem:DescribeFileSystemPolicy",
                "elasticfilesystem:DescribeAccessPoints",
                "elasticfilesystem:DescribeFileSystems",
                "elasticfilesystem:DescribeMountTargetSecurityGroups",
                "execute-api:*",
                "kms:ReEncrypt*",
                "kms:List*",
                "kms:Get*",
                "kms:GenerateDataKey*",
                "kms:Encrypt",
                "kms:Describe*",
                "kms:Decrypt",
                "cloudtrail:LookupEvents",
                "cloudtrail:GetTrail",
                "cloudtrail:ListTrails",
                "cloudtrail:ListPublicKeys",
                "cloudtrail:ListTags",
                "cloudtrail:GetTrailStatus",
                "cloudtrail:GetEventSelectors",
                "cloudtrail:GetInsightSelectors",
                "cloudtrail:DescribeTrails",
                "aws-portal:ViewBilling",
                "logs:List*",
                "logs:Get*",
                "logs:Describe*",
                "logs:Start*",
                "logs:Stop*",
                "athena:List*",
                "athena:Get*",
                "batch:List*",
                "batch:Describe*",
                "glue:List*",
                "glue:Get*",
                "glue:Describe*",
                "events:List*",
                "events:Describe*",
                "events:Test*",
                "ses:List*",
                "ses:Get*"
            ],
            "Effect": "Allow",
            "Resource": [
                "arn:aws:apigateway:us-east-1::/apis/*",
                "arn:aws:sns:us-east-1:${account_id}:*",
                "arn:aws:sqs:us-east-1:${account_id}:*",
                "arn:aws:cloudwatch:us-east-1:${account_id}:*",
                "arn:aws:elasticfilesystem:us-east-1:${account_id}:*",
                "arn:aws:kms:us-east-1:${account_id}:*"
            ]
        },
        {
            "Sid": "SecretAccessOnly",
            "Action": [
                "secretsmanager:Describe*",
                "secretsmanager:Put*",
                "secretsmanager:Get*",
                "secretsmanager:Update*",
                "secretsmanager:List*",
                "secretsmanager:Create*",
                "secretsmanager:Tag*"
            ],
            "Effect": "Allow",
            "Resource": "arn:aws:secretsmanager:us-east-1:${account_id}:*",
            "Condition": {
                "StringEquals": {
                    "aws:ResourceTag/Project": "TagtobeAdded"
                }
            }
        },
        {
            "Sid": "DenyVPCRDSS3Actions",
            "Effect": "Deny",
            "Action": [
                "ec2:CreateVpc*",
                "rds:Create*",
                "rds:Delete*",
                "s3:CreateBucket",
                "s3:DeleteBucket"
            ],
            "Resource": "*"
        },
        {
            "Sid": "DenyOtherDeleteActions",
            "Effect": "Deny",
            "Action": [
                "apigateway:Delete*",
                "logs:Delete*",
                "elasticfilesystem:Delete*",
                "ecs:Delete*",
                "sns:Delete*",
                "sqs:Delete*",
                "cloudwatch:Delete*",
                "events:DeleteRule",
                "kafka:Delete*"
            ],
            "Resource": "*"
        },
        {
            "Sid": "newBillingActions",
            "Effect": "Allow",
            "Action": [
                "billing:Get*",
                "account:Get*",
                "cur:Get*"
            ],
            "Resource": "*"
        }
    ]
}
