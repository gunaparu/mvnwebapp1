import boto3

# Initialize Boto3 clients for S3 and CloudTrail
s3_client = boto3.client('s3')
cloudtrail_client = boto3.client('cloudtrail')

# Define the S3 bucket name you want to monitor
bucket_name = 'your-bucket-name'

# Step 1: List objects in the S3 bucket
def list_objects():
    response = s3_client.list_objects_v2(Bucket=bucket_name)
    for obj in response.get('Contents', []):
        print(f"Object: {obj['Key']}")

# Step 2: Retrieve CloudTrail logs for S3 bucket
def get_cloudtrail_logs():
    events = cloudtrail_client.lookup_events(LookupAttributes=[{'AttributeKey': 'ResourceName', 'AttributeValue': f'arn:aws:s3:::{bucket_name}'}])
    for event in events.get('Events', []):
        print(f"Event Name: {event['EventName']}")
        print(f"User: {event['Username']}")
        print(f"Event Time: {event['EventTime']}")
        print(f"Event Source: {event['EventSource']}")
        print("\n")

# Step 3: Access S3 bucket access logs (if enabled)
# You would typically parse and analyze these logs to gather more detailed information.

# Run the functions
list_objects()
get_cloudtrail_logs()
